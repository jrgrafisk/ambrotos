{% extends 'base.html' %}

{% block title %}Kalender â€“ Ambrotos{% endblock %}

{% block head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css">
{% endblock %}

{% block content %}
<div class="app-layout">

  <!-- â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <nav class="navbar">
    <div class="navbar-brand">ðŸ“… Ambrotos Kalender</div>
    <div class="navbar-user">
      <span class="user-dot" style="background: {{ current_user.color }}"></span>
      <span class="user-name">{{ current_user.username }}</span>
      {% if current_user.is_admin %}
      <a href="{{ url_for('admin_panel') }}" class="btn btn-sm btn-outline">âš™ Admin</a>
      {% endif %}
      <a href="{{ url_for('logout') }}" class="btn btn-sm btn-outline">Log ud</a>
    </div>
  </nav>

  <!-- â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="main-content">

    <!-- Calendar -->
    <div class="calendar-panel">
      <div class="calendar-toolbar">
        <button id="eventModeBtn" class="btn btn-outline btn-sm event-mode-btn" onclick="toggleEventMode()">
          + Opret event
        </button>
        <span id="eventModeHint" class="event-mode-hint" style="display:none">
          Klik pÃ¥ en dato for at oprette et event
        </span>
      </div>
      <div id="calendar"></div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">

      <!-- Legend -->
      <div class="card legend-card">
        <h3 class="card-title">Medlemmer</h3>
        <div class="legend-list">
          {% for user in users %}
          <div class="legend-item">
            <span class="legend-dot" style="background: {{ user.color }}"></span>
            <span class="legend-name {% if user.id == current_user.id %}legend-you{% endif %}">
              {{ user.username }}{% if user.id == current_user.id %} <em>(dig)</em>{% endif %}
            </span>
          </div>
          {% endfor %}
        </div>
      </div>

      <!-- Upcoming Events -->
      <div class="card events-card">
        <h3 class="card-title">Kommende events</h3>
        <div id="upcomingEvents" class="upcoming-events-list">
          <p class="events-empty">IndlÃ¦serâ€¦</p>
        </div>
      </div>

    </aside>
  </div>
</div>

<!-- â”€â”€ Date detail modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="modal-overlay" id="modalOverlay" style="display:none" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="modal-header">
      <h3 id="modalDate">Dato</h3>
      <button class="modal-close" id="modalClose" aria-label="Luk">&times;</button>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<!-- â”€â”€ Event create modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="modal-overlay" id="eventCreateOverlay" style="display:none" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="modal-header">
      <h3 id="eventCreateDate">Nyt event</h3>
      <button class="modal-close" onclick="closeEventCreateModal()" aria-label="Luk">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="eventTitle">Navn</label>
        <input type="text" id="eventTitle" placeholder="Navn pÃ¥ eventâ€¦" autocomplete="off">
      </div>
      <div class="form-group">
        <label for="eventDesc">Beskrivelse (valgfri)</label>
        <textarea id="eventDesc" rows="3" placeholder="Kort beskrivelseâ€¦"></textarea>
      </div>
      <div class="modal-actions">
        <button class="btn btn-primary btn-full" onclick="submitEventCreate()">Opret event</button>
      </div>
    </div>
  </div>
</div>

<!-- â”€â”€ Event detail modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="modal-overlay" id="eventDetailOverlay" style="display:none" role="dialog" aria-modal="true">
  <div class="modal modal-wide">
    <div class="modal-header">
      <h3 id="eventDetailTitle">Event</h3>
      <button class="modal-close" onclick="closeEventDetailModal()" aria-label="Luk">&times;</button>
    </div>
    <div class="modal-body">
      <p class="event-detail-date" id="eventDetailDate"></p>
      <p class="event-detail-desc" id="eventDetailDesc"></p>
      <p class="event-detail-creator" id="eventDetailCreator"></p>
      <div class="event-detail-actions" id="eventDetailActions"></div>
      <div class="attendance-section" id="eventAttendance"></div>
      <div class="comments-section">
        <h4 class="comments-title">Kommentarer</h4>
        <div id="eventComments" class="comments-list"></div>
        <div class="comment-input-area">
          <input type="text" id="commentInput" placeholder="Skriv en kommentarâ€¦" autocomplete="off">
          <button class="btn btn-primary btn-sm" onclick="submitComment()">Send</button>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/locales-all.global.min.js"></script>
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
{% endblock %}
